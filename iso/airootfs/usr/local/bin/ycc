#!/bin/bash

# __   __    _   _ _   _ ___  __
# \ \ / /__ | | | | \ | (_) \/ /
#  \ V / _ \| | | |  \| | |\  / 
#   | | (_) | |_| | |\  | |/  \ 
#   |_|\___/ \___/|_| \_|_/_/\_\
#
# Lisence GPL3
# Homepage: https://github.com/apapamarkou/younix
# Author: Andrianos Papamarkou
# Email: papamarkoua@gmail.com

#
# YoUNiX Control Center
#

SCRIPT_NAME=$(basename "$0")
TITLE="Control Center"

show_help() {
    echo "$DISTRO_NAME $TITLE"
    echo "Usage: $SCRIPT_NAME [OPTIONS]"
    echo "Options:"
    echo "  -t    Open in terminal"
    echo "  -h    Show this help"
}

open_terminal() {
    flock -n $LOCK_DIR/$SCRIPT_NAME.lock terminal --columns=55 --lines=17 --title="$FLOATING_PREFIX $TITLE" $SCRIPT_NAME
}

display_menu() {
    while true; do
        clear
        yprint -c --color=yellow "$DISTRO_NAME $TITLE"

        # relative fzf height by terminal height
        height=$(($(tput lines) - 1))

        choice=$(echo -e "󰍹  Display\n  Look & Theme\n  System Control\n󰀂  Network\n  Bluetooth\n  Terminal Preferences\n󰗅  Sound\n  Localization\n  System Maintenance\n  Users/Groups\n⚡ Energy\n󰐥  Power Actions\n  Exit" | fzf --layout=reverse --prompt="  > " --height=$height)
        [ -z "$choice" ] && exit 0
        
        case "$choice" in
            *Display*) ycdisplay -e ;;
            *Look*) yclook -e ;;
            *Control*) ycsystemcontrol -e ;;
            *Network*) netconf ;;
            *Bluetooth*) bluetoothwindow ;;
            *Terminal*) xfce4-terminal --preferences ;;
            *Sound*) ycsound -e ;;
            *Localization*) yclocalization -e ;;
            *Maintenance*) ycsystem -e ;;
            *Users/Groups*) ycusersandgroups -e ;;
            *Energy*) ycenergy -e ;;
            *Power*) ycpower -e ;;
            *) exit 0 ;;
        esac
    done
}

OPEN_TERMINAL=false

while getopts "th" opt; do
    case $opt in
        t) OPEN_TERMINAL=true ;;
        h) show_help; exit 0 ;;
        \?) echo "Invalid option. Use -h for help."; exit 1 ;;
    esac
done

if [ "$OPEN_TERMINAL" = true ]; then
    open_terminal
    exit 0
fi

display_menu
