#!/usr/bin/env bash

# Free space of /
main="󱛟 $(df -BG / | awk 'NR==2 {print $4}')"

# All real drives (skip tmpfs/devtmpfs/dev/run)
tooltip=$(df -BG | awk 'NR>1 && $1 !~ /^tmpfs$/ && $1 !~ /^devtmpfs$/ && $1 !~ /^dev$/ && $1 !~ /^run$/ {print "󱛟 " $6 " Total:" $2 " Free:" $4 " Device:" $1}')

# Escape tooltip for JSON
tooltip_escaped=$(printf "%s" "$tooltip" | sed ':a;N;$!ba;s/\n/\\n/g' | sed 's/"/\\"/g')

# Output JSON
printf '{"text":"%s","tooltip":"%s"}' "$main" "$tooltip_escaped"
